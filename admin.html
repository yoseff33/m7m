<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة Iron Plus | Command Center v5.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/admin.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--metal-gray);
            padding-bottom: 10px;
            flex-wrap: wrap;
        }
        .admin-tab {
            background: var(--dark-bg);
            border: 1px solid var(--metal-gray);
            color: var(--text-light);
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 600;
        }
        .admin-tab:hover {
            background: rgba(155, 17, 30, 0.2);
            border-color: var(--iron-red);
        }
        .admin-tab.active {
            background: var(--iron-red);
            color: white;
            border-color: var(--iron-red);
        }
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        .tab-content.active {
            display: block;
        }
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .settings-card {
            background: var(--card-bg);
            border: 1px solid var(--metal-gray);
            border-radius: 10px;
            padding: 20px;
        }
        .settings-card h3 {
            color: var(--gold);
            margin-bottom: 15px;
            border-bottom: 1px solid var(--metal-gray);
            padding-bottom: 10px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-light);
            font-weight: 500;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--metal-gray);
            border-radius: 5px;
            color: white;
            font-family: 'Rajdhani', sans-serif;
        }
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--metal-gray);
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: var(--iron-red);
        }
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        .social-inputs {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 10px;
            align-items: center;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .admin-btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .admin-btn-group .btn-iron {
            flex: 1;
            min-width: 150px;
        }
    </style>
</head>
<body class="iron-theme">
    
    <div id="adminLoginScreen" class="auth-overlay">
        <div class="hud-card login-box text-center">
            <h2 class="tech-font text-glow-red">ADMIN LOGIN v5.0</h2>
            <form id="adminLoginForm">
                <input type="text" id="adminUsername" class="input-iron" placeholder="اسم المستخدم" required>
                <input type="password" id="adminPassword" class="input-iron" placeholder="كلمة المرور" required>
                <div id="loginMessage" style="margin-bottom: 10px; font-size: 0.9rem;"></div>
                <button type="submit" class="btn-iron w-full">دخول الأنظمة</button>
            </form>
        </div>
    </div>

    <div id="adminDashboard" class="container" style="display:none; padding: 40px 20px;">
        <div class="dashboard-header flex justify-between items-center">
            <h1 class="tech-font text-glow-gold">IRON+ COMMAND CENTER v5.0</h1>
            <div class="flex items-center gap-4">
                <span id="adminName" class="text-gold"></span>
                <button onclick="logoutAdmin()" class="btn-iron" style="background:var(--metal-gray)">خروج</button>
            </div>
        </div>

        <div class="admin-tabs">
            <button class="admin-tab active" onclick="switchTab('dashboard')">لوحة التحكم</button>
            <button class="admin-tab" onclick="switchTab('products')">المنتجات</button>
            <button class="admin-tab" onclick="switchTab('settings')">إعدادات الموقع</button>
            <button class="admin-tab" onclick="switchTab('marketing')">التسويق والـ SEO</button>
            <button class="admin-tab" onclick="switchTab('content')">إدارة المحتوى</button>
            <button class="admin-tab" onclick="switchTab('coupons')">الكوبونات</button>
            <button class="admin-tab" onclick="switchTab('banners')">البانرات</button>
            <button class="admin-tab" onclick="switchTab('security')">الأمان</button>
            <button class="admin-tab" onclick="switchTab('orders')">الطلبات</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboardTab" class="tab-content active">
            <div class="grid-layout" style="margin-top: 20px; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                <div class="hud-card text-center">
                    <small>إجمالي المبيعات</small>
                    <h2 id="totalSales" class="text-glow-gold">0 ر.س</h2>
                </div>
                <div class="hud-card text-center">
                    <small>الأكواد المتوفرة</small>
                    <h2 id="availableCodes" class="text-glow-red">0</h2>
                </div>
                <div class="hud-card text-center">
                    <small>العملاء</small>
                    <h2 id="totalCustomers">0</h2>
                </div>
                <div class="hud-card text-center">
                    <small>الزيارات اليومية</small>
                    <h2 id="dailyVisits">0</h2>
                </div>
            </div>

            <div class="grid-layout" style="margin-top: 30px;">
                <div class="hud-card">
                    <h3 class="text-gold"><i class="fas fa-chart-line"></i> إحصائيات سريعة</h3>
                    <div style="overflow-x:auto">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>الفترة</th>
                                    <th>المبيعات</th>
                                    <th>الطلبات</th>
                                    <th>العملاء الجدد</th>
                                    <th>متوسط القيمة</th>
                                </tr>
                            </thead>
                            <tbody id="quickStatsBody">
                                <tr>
                                    <td>اليوم</td>
                                    <td id="salesToday">0 ر.س</td>
                                    <td id="ordersToday">0</td>
                                    <td id="customersToday">0</td>
                                    <td id="avgOrderToday">0 ر.س</td>
                                </tr>
                                <tr>
                                    <td>هذا الأسبوع</td>
                                    <td id="salesWeek">0 ر.س</td>
                                    <td id="ordersWeek">0</td>
                                    <td id="customersWeek">0</td>
                                    <td id="avgOrderWeek">0 ر.س</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="hud-card">
                    <h3 class="text-gold"><i class="fas fa-bell"></i> نشاط حديث</h3>
                    <div id="recentActivity" style="max-height: 300px; overflow-y: auto;">
                        <!-- سيتم ملؤها عبر JavaScript -->
                        <div class="text-center py-8 text-gray-400">
                            <i class="fas fa-spinner fa-spin"></i> جاري تحميل النشاط...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Products Tab -->
        <div id="productsTab" class="tab-content">
            <div class="grid-layout" style="margin-top: 30px;">
                <div class="hud-card">
                    <div class="flex justify-between items-center" style="margin-bottom: 20px;">
                        <h3 class="text-gold"><i class="fas fa-dollar-sign"></i> التحكم بالباقات</h3>
                        <button onclick="adminPanel.showProductModal()" class="btn-iron btn-small">+ جديد</button>
                    </div>
                    <div style="overflow-x:auto">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>الصورة</th>
                                    <th>الاسم</th>
                                    <th>السعر</th>
                                    <th>المدة</th>
                                    <th>المخزون</th>
                                    <th>العمليات</th>
                                </tr>
                            </thead>
                            <tbody id="productsTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <div class="hud-card">
                    <h3 class="text-gold"><i class="fas fa-key"></i> شحن المخزن (Bulk)</h3>
                    <label>اختر المنتج:</label>
                    <select id="productForCodes" class="input-iron"></select>
                    <label>الأكواد (كود في كل سطر):</label>
                    <textarea id="bulkCodesText" class="input-iron" rows="6" placeholder="مثال:
IRON-XXXX-YYYY
IRON-ZZZZ-AAAA"></textarea>
                    <button onclick="adminPanel.uploadCodes()" class="btn-iron w-full">تحديث المخزون</button>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settingsTab" class="tab-content">
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-cog"></i> الإعدادات العامة</h3>
                    <form id="siteSettingsForm">
                        <div class="form-group">
                            <label>اسم الموقع</label>
                            <input type="text" id="siteName" class="input-iron" placeholder="IRON+ Store">
                        </div>
                        <div class="form-group">
                            <label>شعار الموقع (URL)</label>
                            <input type="text" id="siteLogo" class="input-iron" placeholder="https://example.com/logo.png">
                        </div>
                        <div class="form-group">
                            <label>أيقونة الموقع (Favicon URL)</label>
                            <input type="text" id="siteFavicon" class="input-iron" placeholder="https://example.com/favicon.ico">
                        </div>
                        <div class="form-group">
                            <label>شريط الإعلانات المتحرك</label>
                            <textarea id="announcementBar" class="input-iron" placeholder="عرض خاص! خصم 20% على جميع الباقات"></textarea>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>وضع الصيانة</span>
                                <label class="switch">
                                    <input type="checkbox" id="maintenanceMode">
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <button type="submit" class="btn-iron w-full">حفظ الإعدادات</button>
                    </form>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-share-alt"></i> وسائل التواصل</h3>
                    <form id="socialSettingsForm">
                        <div class="form-group">
                            <label>رقم الواتساب للدعم</label>
                            <input type="text" id="whatsappNumber" class="input-iron" placeholder="966XXXXXXXXX">
                        </div>
                        <div class="form-group">
                            <label>اسم مستخدم سناب شات</label>
                            <input type="text" id="snapchatUsername" class="input-iron" placeholder="ironplus_sa">
                        </div>
                        <div class="form-group">
                            <label>اسم مستخدم تيك توك</label>
                            <input type="text" id="tiktokUsername" class="input-iron" placeholder="@ironplus">
                        </div>
                        <div class="form-group">
                            <label>اسم مستخدم تويتر</label>
                            <input type="text" id="twitterUsername" class="input-iron" placeholder="@ironplus">
                        </div>
                        <div class="form-group">
                            <label>البريد الإلكتروني</label>
                            <input type="email" id="contactEmail" class="input-iron" placeholder="support@ironplus.com">
                        </div>
                        <button type="submit" class="btn-iron w-full">حفظ وسائل التواصل</button>
                    </form>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-money-bill-wave"></i> إعدادات الدفع</h3>
                    <form id="paymentSettingsForm">
                        <div class="form-group">
                            <label>نسبة الضريبة (%)</label>
                            <input type="number" id="taxRate" class="input-iron" value="15" min="0" max="100" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>الحد الأدنى للطلب (ر.س)</label>
                            <input type="number" id="minOrderAmount" class="input-iron" value="0" min="0">
                        </div>
                        <div class="form-group">
                            <label>رسوم التوصيل (ر.س)</label>
                            <input type="number" id="deliveryFee" class="input-iron" value="0" min="0">
                        </div>
                        <div class="form-group">
                            <label>وحدات العملة</label>
                            <select id="currency" class="input-iron">
                                <option value="SAR" selected>ريال سعودي (ر.س)</option>
                                <option value="USD">دولار ($)</option>
                                <option value="AED">درهم إماراتي (د.إ)</option>
                            </select>
                        </div>
                        <button type="submit" class="btn-iron w-full">حفظ إعدادات الدفع</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Marketing Tab -->
        <div id="marketingTab" class="tab-content">
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-search"></i> إعدادات SEO</h3>
                    <form id="seoSettingsForm">
                        <div class="form-group">
                            <label>Meta Title العام</label>
                            <input type="text" id="metaTitle" class="input-iron" placeholder="IRON+ | متجر تطبيقات البلس">
                        </div>
                        <div class="form-group">
                            <label>Meta Description</label>
                            <textarea id="metaDescription" class="input-iron" rows="3" placeholder="متجر ايرون بلس - تفعيل فوري تطبيقات بلس، فك حظر سناب، واشتراكات رقمية"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Meta Keywords</label>
                            <textarea id="metaKeywords" class="input-iron" rows="3" placeholder="سناب بلس, تيك توك بلس, فك حظر سناب, تطبيقات بلس"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Canonical URL</label>
                            <input type="text" id="canonicalUrl" class="input-iron" placeholder="https://ironplus.com">
                        </div>
                        <button type="submit" class="btn-iron w-full">حفظ إعدادات SEO</button>
                    </form>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-chart-pie"></i> أدوات التتبع</h3>
                    <form id="trackingSettingsForm">
                        <div class="form-group">
                            <label>Google Analytics ID</label>
                            <input type="text" id="googleAnalyticsId" class="input-iron" placeholder="UA-XXXXXXXXX-X">
                        </div>
                        <div class="form-group">
                            <label>Snapchat Pixel ID</label>
                            <input type="text" id="snapchatPixelId" class="input-iron" placeholder="XXXXXXXXXXXXXXXX">
                        </div>
                        <div class="form-group">
                            <label>Facebook Pixel ID</label>
                            <input type="text" id="facebookPixelId" class="input-iron" placeholder="XXXXXXXXXXXXXXXX">
                        </div>
                        <div class="form-group">
                            <label>Twitter Pixel ID</label>
                            <input type="text" id="twitterPixelId" class="input-iron" placeholder="XXXXXXXXXXXXXXXX">
                        </div>
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>تفعيل تتبع التحويلات</span>
                                <label class="switch">
                                    <input type="checkbox" id="conversionTracking" checked>
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <button type="submit" class="btn-iron w-full">حفظ إعدادات التتبع</button>
                    </form>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-bullhorn"></i> إشعارات حية</h3>
                    <form id="notificationsSettingsForm">
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>تفعيل الإشعارات الحية</span>
                                <label class="switch">
                                    <input type="checkbox" id="liveNotifications" checked>
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <div class="form-group">
                            <label>فترة عرض الإشعار (ثانية)</label>
                            <input type="number" id="notificationDuration" class="input-iron" value="10" min="3" max="60">
                        </div>
                        <div class="form-group">
                            <label>النصوص البديلة للإشعارات</label>
                            <textarea id="notificationTexts" class="input-iron" rows="4" placeholder="مستخدم اشترى الآن!
تم تحديث المخزون
عرض خاص محدود"></textarea>
                            <small class="text-gray-400">كل سطر يمثل نص إشعار مختلف</small>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>إظهار إشعارات الطلبات الحقيقية</span>
                                <label class="switch">
                                    <input type="checkbox" id="realOrderNotifications" checked>
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <button type="submit" class="btn-iron w-full">حفظ إعدادات الإشعارات</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Content Tab -->
        <div id="contentTab" class="tab-content">
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-file-contract"></i> سياسة الاسترجاع</h3>
                    <form id="refundPolicyForm">
                        <div class="form-group">
                            <label>عنوان الصفحة</label>
                            <input type="text" id="refundPolicyTitle" class="input-iron" value="سياسة الاسترجاع والإستبدال">
                        </div>
                        <div class="form-group">
                            <label>محتوى الصفحة</label>
                            <textarea id="refundPolicyContent" class="input-iron" rows="12" placeholder="أدخل محتوى سياسة الاسترجاع هنا..."></textarea>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>تفعيل الصفحة</span>
                                <label class="switch">
                                    <input type="checkbox" id="refundPolicyActive" checked>
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <button type="submit" class="btn-iron w-full">حفظ سياسة الاسترجاع</button>
                    </form>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-gavel"></i> الشروط والأحكام</h3>
                    <form id="termsForm">
                        <div class="form-group">
                            <label>عنوان الصفحة</label>
                            <input type="text" id="termsTitle" class="input-iron" value="الشروط والأحكام">
                        </div>
                        <div class="form-group">
                            <label>محتوى الصفحة</label>
                            <textarea id="termsContent" class="input-iron" rows="12" placeholder="أدخل محتوى الشروط والأحكام هنا..."></textarea>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>تفعيل الصفحة</span>
                                <label class="switch">
                                    <input type="checkbox" id="termsActive" checked>
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <button type="submit" class="btn-iron w-full">حفظ الشروط والأحكام</button>
                    </form>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-users"></i> صفحة من نحن</h3>
                    <form id="aboutForm">
                        <div class="form-group">
                            <label>عنوان الصفحة</label>
                            <input type="text" id="aboutTitle" class="input-iron" value="من نحن">
                        </div>
                        <div class="form-group">
                            <label>محتوى الصفحة</label>
                            <textarea id="aboutContent" class="input-iron" rows="12" placeholder="أدخل محتوى صفحة من نحن هنا..."></textarea>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>تفعيل الصفحة</span>
                                <label class="switch">
                                    <input type="checkbox" id="aboutActive" checked>
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <button type="submit" class="btn-iron w-full">حفظ صفحة من نحن</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Coupons Tab -->
        <div id="couponsTab" class="tab-content">
            <div class="grid-layout" style="margin-top: 30px;">
                <div class="hud-card">
                    <div class="flex justify-between items-center" style="margin-bottom: 20px;">
                        <h3 class="text-gold"><i class="fas fa-tag"></i> إدارة الكوبونات</h3>
                        <button onclick="adminPanel.showCouponModal()" class="btn-iron btn-small">+ كوبون جديد</button>
                    </div>
                    <div style="overflow-x:auto">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>كود الكوبون</th>
                                    <th>نوع الخصم</th>
                                    <th>القيمة</th>
                                    <th>الحد الأدنى</th>
                                    <th>الحد الأقصى</th>
                                    <th>المستخدم</th>
                                    <th>تاريخ الانتهاء</th>
                                    <th>الحالة</th>
                                    <th>العمليات</th>
                                </tr>
                            </thead>
                            <tbody id="couponsTableBody">
                                <!-- سيتم ملؤها عبر JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="hud-card">
                    <h3 class="text-gold"><i class="fas fa-plus-circle"></i> إنشاء كوبون جديد</h3>
                    <form id="couponForm" onsubmit="adminPanel.createCoupon(event)">
                        <div class="form-group">
                            <label>كود الكوبون</label>
                            <input type="text" id="couponCode" class="input-iron" placeholder="IRON50" required>
                        </div>
                        <div class="form-group">
                            <label>نوع الخصم</label>
                            <select id="discountType" class="input-iron" required>
                                <option value="percentage">نسبة مئوية %</option>
                                <option value="fixed">مبلغ ثابت</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>قيمة الخصم</label>
                            <input type="number" id="discountValue" class="input-iron" placeholder="50" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label>الحد الأدنى للطلب (ر.س)</label>
                            <input type="number" id="minOrder" class="input-iron" placeholder="0" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>الحد الأقصى للاستخدام</label>
                            <input type="number" id="maxUses" class="input-iron" placeholder="غير محدود">
                        </div>
                        <div class="form-group">
                            <label>تاريخ الانتهاء</label>
                            <input type="date" id="expiryDate" class="input-iron">
                        </div>
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>تفعيل الكوبون</span>
                                <label class="switch">
                                    <input type="checkbox" id="couponActive" checked>
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <button type="submit" class="btn-iron w-full">إنشاء الكوبون</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Banners Tab -->
        <div id="bannersTab" class="tab-content">
            <div class="grid-layout" style="margin-top: 30px;">
                <div class="hud-card">
                    <div class="flex justify-between items-center" style="margin-bottom: 20px;">
                        <h3 class="text-gold"><i class="fas fa-image"></i> إدارة البانرات</h3>
                        <button onclick="adminPanel.showBannerModal()" class="btn-iron btn-small">+ بانر جديد</button>
                    </div>
                    <div style="overflow-x:auto">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>الصورة</th>
                                    <th>العنوان</th>
                                    <th>الموقع</th>
                                    <th>الرابط</th>
                                    <th>الترتيب</th>
                                    <th>الحالة</th>
                                    <th>العمليات</th>
                                </tr>
                            </thead>
                            <tbody id="bannersTableBody">
                                <!-- سيتم ملؤها عبر JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="hud-card">
                    <h3 class="text-gold"><i class="fas fa-upload"></i> رفع بانر جديد</h3>
                    <form id="bannerUploadForm">
                        <div class="form-group">
                            <label>عنوان البانر</label>
                            <input type="text" id="bannerTitle" class="input-iron" placeholder="عرض خاص!" required>
                        </div>
                        <div class="form-group">
                            <label>رابط الصورة</label>
                            <input type="text" id="bannerImage" class="input-iron" placeholder="https://example.com/banner.jpg" required>
                        </div>
                        <div class="form-group">
                            <label>الرابط عند الضغط</label>
                            <input type="text" id="bannerLink" class="input-iron" placeholder="https://ironplus.com/products">
                        </div>
                        <div class="form-group">
                            <label>الموقع</label>
                            <select id="bannerPosition" class="input-iron" required>
                                <option value="hero">الهيرو (أعلى الصفحة)</option>
                                <option value="middle">منتصف الصفحة</option>
                                <option value="bottom">أسفل الصفحة</option>
                                <option value="sidebar">الشريط الجانبي</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>الترتيب</label>
                            <input type="number" id="bannerOrder" class="input-iron" value="1" min="1">
                        </div>
                        <div class="form-group">
                            <label>نص بديل (Alt Text)</label>
                            <input type="text" id="bannerAlt" class="input-iron" placeholder="عرض خاص على باقات سناب بلس">
                        </div>
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>تفعيل البانر</span>
                                <label class="switch">
                                    <input type="checkbox" id="bannerActive" checked>
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <button type="submit" class="btn-iron w-full">رفع البانر</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Security Tab -->
        <div id="securityTab" class="tab-content">
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-user-shield"></i> تغيير بيانات المسؤول</h3>
                    <form id="adminCredentialsForm">
                        <div class="form-group">
                            <label>اسم المستخدم الحالي</label>
                            <input type="text" class="input-iron" value="admin" disabled>
                        </div>
                        <div class="form-group">
                            <label>اسم المستخدم الجديد</label>
                            <input type="text" id="newUsername" class="input-iron" placeholder="اسم المستخدم الجديد">
                        </div>
                        <div class="form-group">
                            <label>كلمة المرور الحالية</label>
                            <input type="password" id="currentPassword" class="input-iron" placeholder="كلمة المرور الحالية" required>
                        </div>
                        <div class="form-group">
                            <label>كلمة المرور الجديدة</label>
                            <input type="password" id="newPassword" class="input-iron" placeholder="كلمة المرور الجديدة">
                        </div>
                        <div class="form-group">
                            <label>تأكيد كلمة المرور الجديدة</label>
                            <input type="password" id="confirmPassword" class="input-iron" placeholder="تأكيد كلمة المرور الجديدة">
                        </div>
                        <div id="credentialsMessage" class="text-red-500 mb-4" style="display: none;"></div>
                        <button type="submit" class="btn-iron w-full">تحديث بيانات المسؤول</button>
                    </form>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-history"></i> سجل الدخول</h3>
                    <div style="overflow-x:auto; max-height: 400px;">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>التاريخ</th>
                                    <th>الوقت</th>
                                    <th>عنوان IP</th>
                                    <th>الحالة</th>
                                </tr>
                            </thead>
                            <tbody id="loginLogsBody">
                                <!-- سيتم ملؤها عبر JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-shield-alt"></i> إعدادات الأمان</h3>
                    <form id="securitySettingsForm">
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>تفعيل التحقق بخطوتين</span>
                                <label class="switch">
                                    <input type="checkbox" id="twoFactorAuth">
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <div class="form-group">
                            <label>عدد المحاولات المسموحة قبل الحظر</label>
                            <input type="number" id="maxLoginAttempts" class="input-iron" value="5" min="1" max="10">
                        </div>
                        <div class="form-group">
                            <label>مدة الحظر (دقائق)</label>
                            <input type="number" id="blockDuration" class="input-iron" value="15" min="1" max="1440">
                        </div>
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>تسجيل نشاط المستخدمين</span>
                                <label class="switch">
                                    <input type="checkbox" id="userActivityLogging" checked>
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; justify-content: space-between; align-items: center;">
                                <span>تفعيل HTTPS الإجباري</span>
                                <label class="switch">
                                    <input type="checkbox" id="forceHTTPS" checked>
                                    <span class="slider"></span>
                                </label>
                            </label>
                        </div>
                        <button type="submit" class="btn-iron w-full">حفظ إعدادات الأمان</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Orders Tab -->
        <div id="ordersTab" class="tab-content">
            <div class="hud-card" style="margin-top: 30px;">
                <div class="flex justify-between items-center" style="margin-bottom: 20px;">
                    <h3 class="text-gold"><i class="fas fa-list"></i> سجل المبيعات والعمليات</h3>
                    <div class="admin-btn-group">
                        <button onclick="loadOrders('all')" class="btn-iron btn-small">الكل</button>
                        <button onclick="loadOrders('completed')" class="btn-iron btn-small" style="background:var(--success-color)">المكتملة</button>
                        <button onclick="loadOrders('pending')" class="btn-iron btn-small" style="background:var(--warning-color)">المعلقة</button>
                        <button onclick="loadOrders('failed')" class="btn-iron btn-small" style="background:var(--error-color)">الفاشلة</button>
                    </div>
                </div>
                <div style="overflow-x:auto">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>العميل</th>
                                <th>المنتج</th>
                                <th>المبلغ</th>
                                <th>الخصم</th>
                                <th>الإجمالي</th>
                                <th>التاريخ</th>
                                <th>الحالة</th>
                                <th>الكود</th>
                                <th>العمليات</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="productModal" class="auth-overlay" style="display:none;">
        <div class="hud-card" style="max-width: 500px; width: 90%;">
            <h2 id="modalTitle" class="tech-font text-gold">إضافة منتج</h2>
            <form id="productForm">
                <input type="hidden" id="productId">
                <input type="text" id="productName" class="input-iron" placeholder="اسم الباقة" required>
                <input type="number" id="productPrice" class="input-iron" placeholder="السعر بالريال" step="0.01" required>
                <input type="text" id="productDuration" class="input-iron" placeholder="المدة (مثلاً: شهر)">
                <input type="text" id="productImage" class="input-iron" placeholder="رابط صورة المنتج">
                <textarea id="productDescription" class="input-iron" placeholder="وصف قصير"></textarea>
                <textarea id="productFeatures" class="input-iron" placeholder="المميزات (كل ميزة في سطر)"></textarea>
                <input type="number" id="productStock" class="input-iron" placeholder="الكمية المتاحة (اختياري)">
                <div class="flex gap-4">
                    <button type="submit" class="btn-iron w-full">حفظ</button>
                    <button type="button" onclick="adminPanel.closeModal()" class="btn-iron w-full" style="background:var(--metal-gray)">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Coupon Modal -->
    <div id="couponModal" class="auth-overlay" style="display:none;">
        <div class="hud-card" style="max-width: 500px; width: 90%;">
            <h2 id="couponModalTitle" class="tech-font text-gold">تعديل الكوبون</h2>
            <form id="couponEditForm">
                <input type="hidden" id="editCouponId">
                <input type="text" id="editCouponCode" class="input-iron" placeholder="كود الكوبون" required>
                <select id="editDiscountType" class="input-iron" required>
                    <option value="percentage">نسبة مئوية %</option>
                    <option value="fixed">مبلغ ثابت</option>
                </select>
                <input type="number" id="editDiscountValue" class="input-iron" placeholder="قيمة الخصم" step="0.01" required>
                <input type="number" id="editMinOrder" class="input-iron" placeholder="الحد الأدنى للطلب">
                <input type="number" id="editMaxUses" class="input-iron" placeholder="الحد الأقصى للاستخدام">
                <input type="date" id="editExpiryDate" class="input-iron">
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="editCouponActive" class="w-4 h-4">
                    <label>تفعيل الكوبون</label>
                </div>
                <div class="flex gap-4 mt-4">
                    <button type="submit" class="btn-iron w-full">تحديث</button>
                    <button type="button" onclick="adminPanel.closeCouponModal()" class="btn-iron w-full" style="background:var(--metal-gray)">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Banner Modal -->
    <div id="bannerModal" class="auth-overlay" style="display:none;">
        <div class="hud-card" style="max-width: 500px; width: 90%;">
            <h2 id="bannerModalTitle" class="tech-font text-gold">تعديل البانر</h2>
            <form id="bannerEditForm">
                <input type="hidden" id="editBannerId">
                <input type="text" id="editBannerTitle" class="input-iron" placeholder="عنوان البانر" required>
                <input type="text" id="editBannerImage" class="input-iron" placeholder="رابط الصورة" required>
                <input type="text" id="editBannerLink" class="input-iron" placeholder="الرابط عند الضغط">
                <select id="editBannerPosition" class="input-iron" required>
                    <option value="hero">الهيرو (أعلى الصفحة)</option>
                    <option value="middle">منتصف الصفحة</option>
                    <option value="bottom">أسفل الصفحة</option>
                    <option value="sidebar">الشريط الجانبي</option>
                </select>
                <input type="number" id="editBannerOrder" class="input-iron" placeholder="الترتيب" min="1">
                <input type="text" id="editBannerAlt" class="input-iron" placeholder="النص البديل">
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="editBannerActive" class="w-4 h-4">
                    <label>تفعيل البانر</label>
                </div>
                <div class="flex gap-4 mt-4">
                    <button type="submit" class="btn-iron w-full">تحديث</button>
                    <button type="button" onclick="adminPanel.closeBannerModal()" class="btn-iron w-full" style="background:var(--metal-gray)">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/supabase-config.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>
